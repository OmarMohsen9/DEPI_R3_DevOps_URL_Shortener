<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>URL Shortener</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    body {
      background: radial-gradient(circle at 30% 30%, #dbeafe, #eff6ff, #f9fafb);
      overflow: hidden;
      position: relative;
      transition: background 0.4s ease, color 0.4s ease;
    }

    .bubble {
      position: absolute;
      border-radius: 50%;
      opacity: 0.6;
      animation: float 10s infinite ease-in-out;
      transition: background-color 0.4s ease;
    }

    @keyframes float {
      0% { transform: translateY(0) scale(1); opacity: 0.6; }
      50% { transform: translateY(-60px) scale(1.1); opacity: 0.9; }
      100% { transform: translateY(0) scale(1); opacity: 0.6; }
    }

    @keyframes fadeUp {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .fade-up { animation: fadeUp 1s ease forwards; }

    /* üåô Dark Mode Styles */
    body.dark-mode {
      background: radial-gradient(circle at 30% 30%, #1e293b, #0f172a, #020617);
      color: #f8fafc;
    }

    body.dark-mode .bg-white {
      background-color: #1e293b !important;
      color: #f8fafc !important;
    }

    body.dark-mode input {
      background-color: #334155;
      border-color: #475569;
      color: #f1f5f9;
    }

    body.dark-mode input::placeholder {
      color: #94a3b8;
    }

    body.dark-mode .bubble {
      opacity: 0.3;
      background-color: #3b82f6 !important;
    }

    /* Title color in dark mode */
    body.dark-mode h2 {
      color: #ffffff !important;
    }
  </style>
</head>

<body class="flex flex-col items-center justify-center min-h-screen relative">

  <!-- üåô Dark Mode Toggle Button -->
  <div class="absolute top-6 right-6 z-20">
    <button id="darkModeToggle"
      class="bg-blue-600 text-white px-4 py-2 rounded-full shadow-md hover:bg-blue-700 transition-all">
      üåô Dark Mode
    </button>
  </div>

  <div class="bubble bg-blue-200 w-32 h-32" style="top: 10%; left: 20%; animation-delay: 0s;"></div>
  <div class="bubble bg-blue-300 w-16 h-16" style="top: 40%; left: 70%; animation-delay: 2s;"></div>
  <div class="bubble bg-indigo-200 w-20 h-20" style="top: 70%; left: 40%; animation-delay: 4s;"></div>
  <div class="bubble bg-blue-100 w-24 h-24" style="top: 85%; left: 10%; animation-delay: 6s;"></div>

  <div class="bg-white shadow-2xl rounded-2xl p-8 w-full max-w-md relative z-10 fade-up" style="animation-delay: 0.3s;">
    <h2 class="text-3xl font-extrabold mb-6 text-gray-800 text-center fade-up" style="animation-delay: 0.5s;">
      üîó URL Shortener
    </h2>

    <input type="text" id="longUrl" placeholder="https://example.com"
      class="w-full p-3 border border-gray-300 rounded-md focus:outline-none focus:ring-4 
             focus:ring-blue-400 mb-5 fade-up" style="animation-delay: 0.7s;">

    <button type="button" onclick="shorten()"
      class="w-full bg-blue-600 hover:bg-blue-700 hover:scale-105 transform transition-all
             text-white font-semibold py-2.5 px-4 rounded-md shadow-md fade-up"
      style="animation-delay: 0.9s;">
      ‚úÇÔ∏è Shorten URL
    </button>

    <p id="result" class="mt-5 text-center font-medium text-gray-700 fade-up" style="animation-delay: 1.2s;"></p>
  </div>

  <script>
    async function shorten() {
      const longUrl = document.getElementById('longUrl').value.trim();
      if (!longUrl) {
        alert("Please enter a URL first!");
        return;
      }

      const response = await fetch("/shorten", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ long_url: longUrl })
      });

      const data = await response.json();
      const result = document.getElementById("result");

      if (response.ok) {
        result.innerHTML = `
          <span class="text-green-600 animate-pulse">‚úÖ Shortened:</span><br>
          <a href="${data.short_url}" target="_blank" 
             class="text-blue-600 underline hover:text-blue-800 transition">
             ${data.short_url}
          </a>
        `;
      } else {
        result.innerHTML = `
          <span class="text-red-600 animate-bounce">‚ùå Error:</span> ${data.detail}
        `;
      }
    }

    // üåó Dark mode toggle logic
    const toggle = document.getElementById('darkModeToggle');
    const body = document.body;

    // Load saved theme
    if (localStorage.getItem('theme') === 'dark') {
      body.classList.add('dark-mode');
      toggle.textContent = '‚òÄÔ∏è Light Mode';
      toggle.classList.replace('bg-blue-600', 'bg-yellow-400');
      toggle.classList.replace('hover:bg-blue-700', 'hover:bg-yellow-500');
    }

    toggle.addEventListener('click', () => {
      body.classList.toggle('dark-mode');
      const isDark = body.classList.contains('dark-mode');
      toggle.textContent = isDark ? '‚òÄÔ∏è Light Mode' : 'üåô Dark Mode';

      if (isDark) {
        toggle.classList.replace('bg-blue-600', 'bg-yellow-400');
        toggle.classList.replace('hover:bg-blue-700', 'hover:bg-yellow-500');
      } else {
        toggle.classList.replace('bg-yellow-400', 'bg-blue-600');
        toggle.classList.replace('hover:bg-yellow-500', 'hover:bg-blue-700');
      }

      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    });

    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll(".fade-up").forEach((el, i) => {
        el.style.opacity = 0;
        el.style.animationDelay = `${0.3 + i * 0.2}s`;
      });
    });
  </script>
</body>
</html>
